import{S as gn,C as U,M,a as le,D as Me,G as P,b as yn,N as fn,g as Se,s as vn,F as bn,c as Pn,H as Mn,T as Sn,d as S,e as D,O as xe,f as p,h as xn,i as Ln,j as It,k as jt,B as kn,P as J,V as v,l as N,m as Cn,n as Yt,I as Gn,o as Rn,p as En,q as Fn,W as Tn,r as An,t as On,u as Ke,E as $e,R as zn,v as Wn,w as In}from"./vendor-BS_NJ1vI.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const w of a.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&i(w)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();const jn=document.querySelector("canvas.webgl"),r=new gn,Y={width:window.innerWidth,height:window.innerHeight},ee=new U(13145664),te=new U(16746496),f=new U(33413),b={neutraBeige:"#D9D4C5",sageGreen:"#A8B79A",warmGray:"#A9A39B",terracotta:"#C67650",paleSkyBlue:"#9EB8C2",oliveBrown:"#5A5A44",sunlitSand:"#E5C69F",mutedTeal:"#6E8D90",charcoalGray:"#4A4A4A"},ue=new M({color:te,opacity:0,transparent:!0,roughness:.5,metalness:.1}),Dt=new le({color:f,emissive:4521796,emissiveIntensity:.9,transparent:!0,opacity:.25,side:Me}),Yn=new le({color:f,emissive:4521796,emissiveIntensity:.9,transparent:!0,opacity:.25,side:Me}),Dn=new le({color:f,emissive:4521796,emissiveIntensity:.9,transparent:!0,opacity:.25,side:Me}),Hn=new le({color:f,emissive:4521796,emissiveIntensity:.9,transparent:!0,opacity:.25,side:Me}),Bn=new le({color:f,emissive:4521796,emissiveIntensity:.9,transparent:!0,opacity:.25,side:Me}),K=new P;r.add(K);function Ht(e,t,n){const i=new On(.5,32),o=new p(i,Dt);o.position.set(e,t,-2),o.scale.set(.2,.2,.2),K.add(o)}const qn=-1.25,Xn=-1.05,Bt=-.26,qt=.24;for(let e=0;e<3;e++)Ht(Bt+e*qt,qn);for(let e=3;e<5;e++)Ht(Bt+(e-3)*qt+.13,Xn);const C=K.children[0];C.material=Dt;const G=K.children[3];G.material=Yn;const R=K.children[1];R.material=Dn;const E=K.children[4];E.material=Hn;const F=K.children[2];F.material=Bn;const _n=[C,G,R,E,F],c=new yn({oscillator:{type:"sawtooth"},envelope:{attack:.01,decay:.1,sustain:.9,release:.5}}).toDestination(),m=new fn().toDestination();c.volume.value=Se(0);c.oscillator.type="sine";c.envelope.attack=.05;c.envelope.sustain=.4;c.envelope.release=.2;m.envelope.attack=.05;m.envelope.sustain=.2;m.envelope.release=.2;window.addEventListener("click",()=>{vn(),console.log("Audio Context Started")});c.filter.frequency.value=500;const ne=new bn({type:"lowpass",frequency:1e3,rolloff:-12,Q:1}).toDestination();c.connect(ne);m.connect(ne);ne.attack=0;ne.decay=0;ne.sustain=0;ne.release=0;m.volume.value=Se(0);Pn().start();const Nn=.5,Vn=new Mn(16777215,ee,Nn);r.add(Vn);const k=new Sn;k.load("textures/stainedGlassA.png");k.load("textures/OceanWave.jpeg");const Zn=k.load("textures/stainedGlassWaveB.jpg");k.load("textures/stainedGlassD.jpg");k.load("textures/Greydient4A_silk_3.png");const Xt=k.load("textures/Greydient4A_texture1_5.jpg"),Kn=k.load("textures/Greydient4B_texture1_6.jpg"),$n=k.load("textures/Greydient4C_texture1_3.jpg");k.load("matcaps/0_export_2.png");const Qn=k.load("matcaps/0_export_6.png");k.load("matcaps/0_export_25.png");const Un=k.load("matcaps/export_92_blur.png"),Le=Math.PI*.12,ke=.3,Ce=1.5,Ge=50,Re=5,Ee=new M({map:Zn,color:16755268,emissive:16729344,emissiveIntensity:.5,transparent:!1,opacity:.7}),_t=new M({color:b.neutraBeige,emissiveIntensity:.2,transparent:!1,opacity:1}),Nt=new S(1,32,32),gt=0,Jn=0,yt=15,Vt=10,H=new D(ee,3);H.position.set(gt,Vt,yt);H.angle=Le;H.penumbra=ke;H.decay=Ce;H.distance=Ge;H.intensity=Re;r.add(H);const ft=new xe;ft.position.set(gt,Jn,yt);r.add(ft);H.target=ft;const ei=new S(1,32,32),Qe=new p(ei,Ee);Qe.position.set(gt,Vt,yt);r.add(Qe);const Fe=0,ti=0,vt=-5,Zt=10,B=new D(ee,3);B.position.set(Fe,Zt,vt);B.angle=Le;B.penumbra=ke;B.decay=Ce;B.distance=Ge;B.intensity=Re;r.add(B);const bt=new xe;bt.position.set(Fe,ti,vt);r.add(bt);B.target=bt;const ni=new S(1,32,32),Kt=new p(ni,Ee);Kt.position.set(Fe,Zt,vt);r.add(Kt);const Pt=0,ii=0,$t=-25,oi=10,q=new D(ee,3);q.position.set(Pt,10,-25);q.angle=Le;q.penumbra=ke;q.decay=Ce;q.distance=Ge;q.intensity=Re;r.add(q);const Mt=new xe;Mt.position.set(Pt,ii,$t);r.add(Mt);q.target=Mt;const ai=new S(1,32,32),St=new p(ai,Ee);St.position.set(Pt,oi,$t);r.add(St);const T=new D(ee,3);T.position.set(0,10,-45);T.angle=Le;T.penumbra=ke;T.decay=Ce;T.distance=Ge;T.intensity=Re;r.add(T);const xt=new xe;xt.position.set(0,0,-45);r.add(xt);T.target=xt;const si=new S(1,32,32),Q=new p(si,Ee);Q.position.set(0,10,-45);r.add(Q);Q.visible=!1;const pe=new p(Nt,_t);pe.position.set(0,10,-45);r.add(pe);pe.visible=!0;T.intensity=0;const V=new D(ee,3);V.position.set(0,10,-65);V.angle=Le;V.penumbra=ke;V.decay=Ce;V.distance=Ge;r.add(V);const Lt=new xe;Lt.position.set(0,0,-65);r.add(Lt);V.target=Lt;const kt=new p(Nt,Ee);kt.position.set(0,10,-65);r.add(kt);V.visible=!0;V.intensity=5;const A=new D(16755251,5);A.position.set(-3,6,20);A.angle=Math.PI/1.5;A.penumbra=.9;A.decay=.2;A.distance=20;A.castShadow=!0;A.shadow.mapSize.width=256;A.shadow.mapSize.height=256;A.intensity=.3;r.add(A);const O=new D(16755251,5);O.position.set(-3,6,0);O.angle=Math.PI/1.7;O.penumbra=.7;O.decay=.2;O.distance=20;O.castShadow=!0;O.shadow.mapSize.width=256;O.shadow.mapSize.height=256;O.intensity=.4;r.add(O);const z=new D(16755251,5);z.position.set(-3,6,-20);z.angle=Math.PI/1.5;z.penumbra=.9;z.decay=.2;z.distance=20;z.castShadow=!0;z.shadow.mapSize.width=256;z.shadow.mapSize.height=256;z.intensity=.3;r.add(z);const W=new D(16755251,5);W.position.set(-3,6,-45);W.angle=Math.PI/1.5;W.penumbra=.9;W.decay=.2;W.distance=20;W.castShadow=!0;W.shadow.mapSize.width=256;W.shadow.mapSize.height=256;W.intensity=.3;r.add(W);const I=new D(16755251,5);I.position.set(-3,6,-64);I.angle=Math.PI/1.5;I.penumbra=.9;I.decay=.2;I.distance=20;I.castShadow=!0;I.shadow.mapSize.width=256;I.shadow.mapSize.height=256;I.intensity=.3;r.add(I);const ri=new U(b.terracotta).lerp(new U(8421504),.001);r.fog=new xn(ri,20,70);const ci=new U(f).lerp(new U(8421504),.2);r.fog=new Ln(ci,.01);const j=new M({color:te});j.roughness=.4;j.metalness=.1;const Ue=new It({color:b.terracotta});Ue.matcap=Qn;Ue.roughness=.4;Ue.metalness=.1;const Ct=new It({color:ee});Ct.matcap=Un;Ct.roughness=.9;Ct.metalness=.1;const At=10,li=150,Qt=new jt(At,At,li,32,16,!1);Qt.computeVertexNormals();const He=new le({map:Xt,color:b.terracotta,side:kn}),Te=new p(Qt,He);Te.rotation.x=Math.PI/2;Te.position.z=-20;Te.receiveShadow=!0;Te.castShadow=!0;r.add(Te);function Ut(e,t,n,i,o,a){const w=new Ke,l=1e-5,h=e/a;w.moveTo(-e/2,0);for(let g=0;g<=a;g++){const _=-e/2+g*h,L=Math.sin(g/a*Math.PI*2)*(t/2);g===0?w.lineTo(_,L):w.quadraticCurveTo(_-h/2,L,_,L)}for(let g=a;g>=0;g--){const _=-e/2+g*h,L=Math.sin(g/a*Math.PI*2)*(t/2);w.lineTo(_,L+l)}const x={steps:1,depth:n,bevelEnabled:!0,bevelThickness:i,bevelSize:i,bevelSegments:4},X=new $e(w,x);return X.center(),X}const Jt=1.33,Ae=.665,en=.266,tn=.0665,di=Ut(Jt,Ae,en,tn,16,64),me=new p(di,j);me.visible=!0;function nn(e,t,n,i,o){const a=new Ke,l=i-1e-5;a.moveTo(0,l),a.lineTo(0,t-l),a.quadraticCurveTo(0,t,l,t),a.lineTo(e-l,t),a.quadraticCurveTo(e,t,e,t-l),a.lineTo(e,l),a.quadraticCurveTo(e,0,e-l,0),a.lineTo(l,0),a.quadraticCurveTo(0,0,0,l);const h=new $e(a,{depth:n-i*2,bevelEnabled:!0,bevelSegments:o*2,steps:1,bevelSize:i,bevelThickness:i,curveSegments:o});return h.center(),h}const ui=nn(.8,.8,.8,.05,16),we=new p(ui,j);we.visible=!1;function on(e,t,n,i,o){const a=new Ke,l=i-1e-5,h=e/2;a.moveTo(-h+l,-t/2),a.lineTo(h-l,-t/2),a.quadraticCurveTo(h,-t/2,h,-t/2+l),a.lineTo(l,t/2-l),a.quadraticCurveTo(0,t/2,-l,t/2-l),a.lineTo(-h,-t/2+l),a.quadraticCurveTo(-h,-t/2,-h+l,-t/2);const x={steps:1,depth:n,bevelEnabled:!0,bevelThickness:i,bevelSize:i,bevelSegments:o},X=new $e(a,x);return X.center(),X}const pi=on(1,.866,.2,.05,4),he=new p(pi,j);he.visible=!1;const de=new P;de.add(me);de.add(we);de.add(he);de.position.set(0,0,15);r.add(de);const mi=16,wi=64,hi=1,gi=.866,yi=.2,fi=.05,vi=4,Gt=new M({color:te,opacity:.5,transparent:!0,roughness:.5,metalness:.1}),bi=Ut(Jt/3,Ae/3,en/3,tn/3,mi,wi),Oe=new p(bi,Gt);Oe.position.set(0,Ae/2+.65,15);r.add(Oe);const Pi=on(hi/3,gi/3,yi/3,fi/3,vi),ze=new p(Pi,Gt),Mi=nn(.8/3,.8/3,.8/3,.05/3,16),We=new p(Mi,Gt);r.add(ze,We);const Si=.7;ze.position.set(-.7,Ae/2+.5,15);We.position.set(Si,Ae/2+.5,15);Oe.visible=!0;ze.visible=!0;We.visible=!0;const Ie=new P;Ie.add(Oe);Ie.add(ze);Ie.add(We);r.add(Ie);let Ot="sine";const u=new zn,s=new Wn,zt=[{mesh:Oe,shape:"sine"},{mesh:ze,shape:"pyramid"},{mesh:We,shape:"cube"}];window.addEventListener("click",e=>{var n;s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,u.setFromCamera(s,d);const t=u.intersectObjects([...zt.map(i=>i.mesh),Qe]);if(t.length>0){const i=t[0].object,o=(n=zt.find(a=>a.mesh===i))==null?void 0:n.shape;o&&xi(o)}});function xi(e){e!==Ot&&(me.visible=e==="sine",he.visible=e==="pyramid",we.visible=e==="cube",e==="sine"?(me.visible=!0,He.map=Xt,c.oscillator.type="sine"):e==="pyramid"?(he.visible=!0,He.map=Kn,c.oscillator.type="triangle"):e==="cube"&&(we.visible=!0,He.map=$n,c.oscillator.type="square"),Ot=e)}const Li=.15;c.volume.value=Se(Li);const je=new P;r.add(je);const Be=7,ct=.2,ki=.05,Ci=new M({color:te,transparent:!0,opacity:.3,roughness:.5,metalness:.1});for(let e=0;e<Be;e++){const t=new S(ki,16,16),n=new p(t,Ci.clone());n.position.set(1.5,e*ct,15),je.add(n)}let $=null;window.addEventListener("mousedown",e=>{s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,u.setFromCamera(s,d);const t=u.intersectObjects(je.children);t.length>0&&($=t[0].object,$.scale.set(2,2,2))});H.intensity=1;window.addEventListener("mousemove",e=>{if($){s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,u.setFromCamera(s,d);const t=new J(new v(0,0,1),-$.position.z),n=new v;u.ray.intersectPlane(t,n);const i=N.clamp(n.y,0,Be*ct);$.position.y=i;const o=i/(Be*ct);an(o*100),c.volume.value=Se(o);const a=o*5;H.intensity=a,$.visible=!0}});window.addEventListener("mouseup",()=>{$=null});function an(e){const t=Math.round(e/100*Be);je.children.forEach((n,i)=>{n.material.opacity=i<t?1:.3})}an(15);const Je=new P;Je.add(de);Je.add(Ie);Je.add(je);r.add(Je);const Gi=Fe,Ri=0,Ei=-5,ge=new P;r.add(ge);new Cn({color:te,transparent:!0,opacity:.5});const Fi=new Yt(.02,.02,.02);function Ti(e){const t=new p(Fi,_t),n=4,i=Math.random()*Math.PI*5,o=Math.acos(2*Math.random()-1);return t.position.set(n*Math.sin(o)*Math.cos(i),n*Math.sin(o)*Math.sin(i),n*Math.cos(o)),t.velocity=new v((Math.random()-.5)*.01,(Math.random()-.5)*.01,(Math.random()-.5)*.01),t}function sn(e,t){ge.clear();for(let n=0;n<e;n++)ge.add(Ti());console.log("Sending grain count to backend:",e)}ge.position.set(Gi,Ri,Ei);sn(500);const et=new P;r.add(et);const qe=7,lt=.2,Ai=.05,Oi=new M({color:te,transparent:!0,opacity:.3,roughness:.5,metalness:.1});for(let e=0;e<qe;e++){const t=new S(Ai,16,16),n=new p(t,Oi.clone());n.position.set(Fe+2.5,e*lt,-5),et.add(n)}let ie=null;window.addEventListener("mousedown",e=>{s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,u.setFromCamera(s,d);const t=u.intersectObjects(et.children);t.length>0&&(ie=t[0].object,ie.scale.set(2,2,2))});B.intensity=1;window.addEventListener("mousemove",e=>{if(ie){s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,u.setFromCamera(s,d);const t=new J(new v(0,0,1),-ie.position.z),n=new v;u.ray.intersectPlane(t,n);const i=N.clamp(n.y,0,qe*lt);ie.position.y=i;const o=i/(qe*lt);m.volume.value=Se(o),sn(o*500),zi(o*100);const a=o*5;B.intensity=a}});window.addEventListener("mouseup",()=>{ie=null});function zi(e){const t=Math.round(e/100*qe);et.children.forEach((n,i)=>{n.material.opacity=i<t?1:.3})}function Wi(e,t,n,i,o){const a=new P,w=new Ke;w.moveTo(-2.5/2,0),w.lineTo(e/2,0);const l=N.degToRad(o),h=Math.cos(l)*t,x=-Math.sin(l)*t;w.lineTo(e/2+h,x),w.quadraticCurveTo(e/2,0,-2.5/2,.2);const X={steps:10,depth:n,bevelEnabled:!0,bevelThickness:i*3,bevelSize:i,bevelSegments:32},g=new $e(w,X);g.center();const _=new p(g,j);return a.add(_),a}const Ii=2.5,ji=2,Yi=.1,Di=.2,Hi=30,rn=Wi(Ii,ji,Yi,Di,Hi);rn.position.set(0,0,-26);r.add(rn);const tt=new P;r.add(tt);const Xe=7,dt=.2,Bi=.05,qi=new M({color:te,transparent:!0,opacity:.3,roughness:.5,metalness:.1});for(let e=0;e<Xe;e++){const t=new S(Bi,16,16),n=new p(t,qi.clone());n.position.set(1.5,e*dt,-25),tt.add(n)}let oe=null;window.addEventListener("mousedown",e=>{s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,u.setFromCamera(s,d);const t=u.intersectObjects(tt.children);t.length>0&&(oe=t[0].object,oe.scale.set(2,2,2))});q.intensity=1;window.addEventListener("mousemove",e=>{if(oe){s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,u.setFromCamera(s,d);const t=new J(new v(0,0,1),-oe.position.z),n=new v;u.ray.intersectPlane(t,n);const i=N.clamp(n.y,0,Xe*dt);oe.position.y=i;const o=i/(Xe*dt),a=20,l=a*Math.pow(2e4/a,o);ne.frequency.value=l,console.log("Logarithmic Filter Cutoff Frequency:",l),console.log(o*2e4),Xi(o*100);const h=o*5;q.intensity=h}});window.addEventListener("mouseup",()=>{oe=null});function Xi(e){const t=Math.round(e/100*Xe);tt.children.forEach((n,i)=>{n.material.opacity=i<t?1:.3})}const nt=new P,_i=25,Ni=1.5;for(let e=0;e<_i;e++){const t=Ni+(Math.random()-.5)*.1,n=Math.random()*Math.PI*2;let i;const o=Math.random();o<.33?i=new S(.05*Math.random()+.03,8,8):o<.66?i=new Yt(.05*Math.random()+.03,.05*Math.random()+.03,.05*Math.random()+.03):i=new Gn(.05*Math.random()+.03,0);const a=new p(i,j);a.position.set(t*Math.cos(n),t*Math.sin(n),0),a.rotation.set(Math.random()*Math.PI,Math.random()*Math.PI,Math.random()*Math.PI),a.userData={initialPosition:a.position.clone(),scale:1},nt.add(a)}nt.position.set(0,0,-45);r.add(nt);const Vi=new jt(2,2,.1,32),Zi=new M({opacity:0,transparent:!0}),cn=new p(Vi,Zi);cn.rotation.x=Math.PI/2;cn.position.z=-45;function Ki(){const e=Date.now()*.001;nt.children.forEach(t=>{const{initialPosition:n,scale:i}=t.userData;t.position.x=n.x+Math.sin(e+t.id)*.1,t.position.y=n.y+Math.cos(e+t.id)*.1,t.scale.set(i,i,i)})}const $i=new Rn;$i.load("fonts/P22 FLLW Exhibition_Regular.json",function(e){function t(wn,hn){return new In(wn,{font:hn,size:11,height:2,curveSegments:12,bevelEnabled:!0,bevelThickness:.1,bevelSize:.5,bevelOffset:0,bevelSegments:5})}const n=t("A",e);t("D",e),t("S",e),t("R",e),new En,new p(n,Ue);const i=.08,o=t("OSC",e),a=new p(o,ue);a.position.set(-2.7,8,18.4),a.scale.set(i,i,i),a.rotation.x=Math.PI/2,a.castShadow=!0,a.receiveShadow=!0,a.transparent=!0,r.add(a),A.target=Qe;const w=t("Noise",e),l=new p(w,ue);l.position.set(-3.2,8,-1.6),l.scale.set(i,i,i),l.rotation.x=Math.PI/2,l.castShadow=!0,l.transparent=!0,r.add(l),O.target=l;const h=t("Filter",e),x=new p(h,ue);x.position.set(-2.9,8,-21.6),x.scale.set(i,i,i),x.rotation.x=Math.PI/2,x.castShadow=!0,x.transparent=!0,r.add(x),z.target=St;const X=t("LFO",e),g=new p(X,ue);g.position.set(-2.8,7.5,-44.3),g.scale.set(i,i,i),g.rotation.x=Math.PI/2,g.castShadow=!0,g.transparent=!0,r.add(g),W.target=Q;const _=t("adsr",e),L=new p(_,ue);L.position.set(-3.5,7.7,-63.7),L.scale.set(i,i,i),L.rotation.x=Math.PI/2,L.castShadow=!0,L.transparent=!0,r.add(L),I.target=kt});const it=new P;r.add(it);const _e=10,ut=.2,Qi=.05,Ui=new M({color:j,transparent:!0,opacity:.3,roughness:.5,metalness:.1});for(let e=0;e<_e;e++){const t=new S(Qi,16,16),n=new p(t,Ui.clone());n.position.set(-3,e*ut,-65),it.add(n)}let ae=null;window.addEventListener("mousedown",e=>{s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,u.setFromCamera(s,d);const t=u.intersectObjects(it.children);t.length>0&&(ae=t[0].object,ae.scale.set(2,2,2))});window.addEventListener("mousemove",e=>{if(ae){s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,u.setFromCamera(s,d);const t=new J(new v(0,0,1),-ae.position.z),n=new v;u.ray.intersectPlane(t,n);const i=N.clamp(n.y,0,_e*ut);ae.position.y=i;const o=i/(_e*ut);console.log(`Volume Level: ${o.toFixed(2)}`),c.envelope.attack=o,m.envelope.attack=o,ln(o*100)}});window.addEventListener("mouseup",()=>{ae=null});function ln(e){const t=Math.round(e/100*_e);it.children.forEach((n,i)=>{i<t?n.material.opacity=1:n.material.opacity=.3})}ln(10);const ot=new P;r.add(ot);const Ne=10,pt=.2,Ji=.05,eo=new M({color:j,transparent:!0,opacity:.3,roughness:.5,metalness:.1});for(let e=0;e<Ne;e++){const t=new S(Ji,16,16),n=new p(t,eo.clone());n.position.set(-1,e*pt,-65),ot.add(n)}let se=null;window.addEventListener("mousedown",e=>{s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,u.setFromCamera(s,d);const t=u.intersectObjects(ot.children);t.length>0&&(se=t[0].object,se.scale.set(2,2,2))});window.addEventListener("mousemove",e=>{if(se){s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,u.setFromCamera(s,d);const t=new J(new v(0,0,1),-se.position.z),n=new v;u.ray.intersectPlane(t,n);const i=N.clamp(n.y,0,Ne*pt);se.position.y=i;const o=i/(Ne*pt);c.envelope.decay=o,m.envelope.decay=o,console.log(`Decay Level: ${o.toFixed(2)}`),dn(o*100)}});window.addEventListener("mouseup",()=>{se=null});function dn(e){const t=Math.round(e/100*Ne);ot.children.forEach((n,i)=>{i<t?n.material.opacity=1:n.material.opacity=.3})}dn(10);const at=new P;r.add(at);const Ve=10,mt=.2,to=.05,no=new M({color:j,transparent:!0,opacity:.3,roughness:.5,metalness:.1});for(let e=0;e<Ve;e++){const t=new S(to,16,16),n=new p(t,no.clone());n.position.set(1,e*mt,-65),at.add(n)}let re=null;window.addEventListener("mousedown",e=>{s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,u.setFromCamera(s,d);const t=u.intersectObjects(at.children);t.length>0&&(re=t[0].object,re.scale.set(2,2,2))});window.addEventListener("mousemove",e=>{if(re){s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,u.setFromCamera(s,d);const t=new J(new v(0,0,1),-re.position.z),n=new v;u.ray.intersectPlane(t,n);const i=N.clamp(n.y,0,Ve*mt);re.position.y=i;const o=i/(Ve*mt);c.envelope.sustain=o,m.envelope.sustain=o,un(o*100)}});window.addEventListener("mouseup",()=>{re=null});function un(e){const t=Math.round(e/100*Ve);at.children.forEach((n,i)=>{i<t?n.material.opacity=1:n.material.opacity=.3})}un(10);const st=new P;r.add(st);const Ze=10,wt=.2,io=.05,oo=new M({color:j,transparent:!0,opacity:.3,roughness:.5,metalness:.1});for(let e=0;e<Ze;e++){const t=new S(io,16,16),n=new p(t,oo.clone());n.position.set(3,e*wt,-65),st.add(n)}let ce=null;window.addEventListener("mousedown",e=>{s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,u.setFromCamera(s,d);const t=u.intersectObjects(st.children);t.length>0&&(ce=t[0].object,ce.scale.set(2,2,2))});window.addEventListener("mousemove",e=>{if(ce){s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,u.setFromCamera(s,d);const t=new J(new v(0,0,1),-ce.position.z),n=new v;u.ray.intersectPlane(t,n);const i=N.clamp(n.y,0,Ze*wt);ce.position.y=i;const o=i/(Ze*wt);c.envelope.release=o,m.envelope.release=o,pn(o*100)}});window.addEventListener("mouseup",()=>{ce=null});function pn(e){const t=Math.round(e/100*Ze);st.children.forEach((n,i)=>{i<t?n.material.opacity=1:n.material.opacity=.3})}pn(10);const d=new Fn(75,Y.width/Y.height);d.position.set(0,0,45);r.add(d);const Z=new Tn({canvas:jn,antialias:!0});Z.setSize(Y.width,Y.height);Z.shadowMap.enabled=!0;Z.shadowMap.type=An;Z.setPixelRatio(Math.min(window.devicePixelRatio,1));Z.setPixelRatio(Math.min(window.devicePixelRatio,1));let Rt=!1,Et=!1,Ft=!1,Tt=!1;const ao=.2,Wt=.02;window.addEventListener("keydown",e=>{switch(e.preventDefault(),e.key.toLowerCase()){case"w":Rt=!0,y=0;break;case"s":Et=!0,y=0;break;case"a":Ft=!0,y=0;break;case"d":Tt=!0,y=0;break}});window.addEventListener("keyup",e=>{switch(e.key.toLowerCase()){case"w":Rt=!1;break;case"s":Et=!1;break;case"a":Ft=!1;break;case"d":Tt=!1;break}});let ye=!1,fe=!1,ve=!1,be=!1,Pe=!1;window.addEventListener("mousedown",e=>{s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,u.setFromCamera(s,d);const t=u.intersectObjects(_n);if(t.length>0){Ye=!0;const n=t[0].object;n===C?(ye=!0,c.triggerAttack("D3"),m.triggerAttack(),y=.2,C.material.color.set(b.paleSkyBlue),C.material.opacity=.9):n===G?(fe=!0,c.triggerAttack("F#3"),m.triggerAttack(),y=.3,G.material.color.set(b.paleSkyBlue),G.material.opacity=.9):n===R?(ve=!0,c.triggerAttack("G3"),m.triggerAttack(),y=.5,R.material.color.set(b.paleSkyBlue),R.material.opacity=.9):n===E?(be=!0,c.triggerAttack("A3"),m.triggerAttack(),y=.6,E.material.color.set(b.paleSkyBlue),E.material.opacity=.9):n===F&&(Pe=!0,c.triggerAttack("C4"),m.triggerAttack(),y=.8,F.material.color.set(b.paleSkyBlue),F.material.opacity=.9)}});window.addEventListener("mouseup",e=>{Ye=!1,ye?(c.triggerRelease(),m.triggerRelease(),C.material.color.set(f),C.material.opacity=.25,ye=!1):fe?(c.triggerRelease(),m.triggerRelease(),G.material.color.set(f),G.material.opacity=.25,fe=!1):ve?(c.triggerRelease(),m.triggerRelease(),R.material.color.set(f),R.material.opacity=.25,ve=!1):be?(c.triggerRelease(),m.triggerRelease(),E.material.color.set(f),E.material.opacity=.25,be=!1):Pe&&(c.triggerRelease(),m.triggerRelease(),F.material.color.set(f),F.material.opacity=.25,Pe=!1)});let ht=null;window.addEventListener("keydown",e=>{e.preventDefault();const t=e.key.toLowerCase();if(ht!==t)switch(ht=t,Ye=!0,e.key.toLowerCase()){case"j":ye=!0,c.triggerAttack("D3"),m.triggerAttack(),y=.2,C.material.color.set(b.paleSkyBlue),C.material.opacity=.9;break;case"k":ve=!0,c.triggerAttack("G3"),m.triggerAttack(),y=.5,R.material.color.set(b.paleSkyBlue),R.material.opacity=.9;break;case"l":Pe=!0,c.triggerAttack("C4"),m.triggerAttack(),y=.8,F.material.color.set(b.paleSkyBlue),F.material.opacity=.9;break;case"i":fe=!0,c.triggerAttack("F#3"),m.triggerAttack(),y=.3,G.material.color.set(b.paleSkyBlue),G.material.opacity=.9;break;case"o":be=!0,c.triggerAttack("A3"),m.triggerAttack(),y=.6,E.material.color.set(b.paleSkyBlue),E.material.opacity=.9}});window.addEventListener("keyup",e=>{switch(Ye=!1,ht=null,e.key.toLowerCase()){case"j":c.triggerRelease(),m.triggerRelease(),C.material.color.set(f),C.material.opacity=.25,ye=!1;break;case"k":c.triggerRelease(),m.triggerRelease(),R.material.color.set(f),R.material.opacity=.25,ve=!1;break;case"l":c.triggerRelease(),m.triggerRelease(),F.material.color.set(f),F.material.opacity=.25,Pe=!1;break;case"i":c.triggerRelease(),m.triggerRelease(),G.material.color.set(f),G.material.opacity=.25,fe=!1;break;case"o":c.triggerRelease(),m.triggerRelease(),E.material.color.set(f),E.material.opacity=.25,be=!1;break}});let rt=!1;window.addEventListener("click",e=>{s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,u.setFromCamera(s,d),u.intersectObject(Q).length>0&&(Q.visible=!Q.visible,pe.visible=!pe.visible,rt?(T.intensity=0,rt=!1):(T.intensity=Re,rt=!0))});d.add(K);let y=.5,Ye=!1;const De={minZ:-85,maxZ:45,radius:9.5};function mn(){requestAnimationFrame(mn),Ki(),Ft&&(d.rotation.y+=Wt),Tt&&(d.rotation.y-=Wt);const e=new v;d.getWorldDirection(e),Rt&&d.position.add(e.multiplyScalar(ao)),Et&&d.position.add(e.multiplyScalar(-.2)),d.position.z=N.clamp(d.position.z,De.minZ,De.maxZ);const t=Math.sqrt(d.position.x**2+d.position.y**2);if(t>De.radius){const n=De.radius/t;d.position.x*=n,d.position.y*=n}ge.children.forEach(n=>{n.position.add(n.velocity);const i=1.25;n.position.length()>i&&(n.position.normalize().multiplyScalar(i),n.velocity.negate()),n.material.opacity=3}),Ye&&(me.rotation.y+=y,he.rotation.y+=y,we.rotation.y+=y),Z.render(r,d)}mn();window.addEventListener("resize",()=>{Y.width=window.innerWidth,Y.height=window.innerHeight,d.aspect=Y.width/Y.height,d.updateProjectionMatrix(),Z.setSize(Y.width,Y.height),Z.setPixelRatio(Math.min(window.devicePixelRatio,2))});
