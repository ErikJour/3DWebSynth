import{S as hn,C as U,M,a as ce,D as Pe,G as P,b as gn,N as yn,g as Me,s as fn,c as vn,H as bn,T as Pn,d as S,e as D,O as Se,f as p,F as Mn,h as Sn,i as Wt,j as It,B as xn,P as J,V as v,k as V,l as Ln,m as jt,I as kn,n as Cn,o as Gn,p as En,W as Rn,q as Tn,r as Fn,t as Ze,E as Ke,R as An,u as On,v as zn}from"./vendor-DSH-t957.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const h of a.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();const Wn=document.querySelector("canvas.webgl"),r=new hn,Y={width:window.innerWidth,height:window.innerHeight},ee=new U(13145664),te=new U(16746496),f=new U(33413),b={neutraBeige:"#D9D4C5",sageGreen:"#A8B79A",warmGray:"#A9A39B",terracotta:"#C67650",paleSkyBlue:"#9EB8C2",oliveBrown:"#5A5A44",sunlitSand:"#E5C69F",mutedTeal:"#6E8D90",charcoalGray:"#4A4A4A"},de=new M({color:te,opacity:0,transparent:!0,roughness:.5,metalness:.1}),Yt=new ce({color:f,emissive:4521796,emissiveIntensity:.9,transparent:!0,opacity:.25,side:Pe}),In=new ce({color:f,emissive:4521796,emissiveIntensity:.9,transparent:!0,opacity:.25,side:Pe}),jn=new ce({color:f,emissive:4521796,emissiveIntensity:.9,transparent:!0,opacity:.25,side:Pe}),Yn=new ce({color:f,emissive:4521796,emissiveIntensity:.9,transparent:!0,opacity:.25,side:Pe}),Dn=new ce({color:f,emissive:4521796,emissiveIntensity:.9,transparent:!0,opacity:.25,side:Pe}),N=new P;r.add(N);function Dt(e,t,n){const i=new Fn(.5,32),o=new p(i,Yt);o.position.set(e,t,-2),o.scale.set(.2,.2,.2),N.add(o)}const Hn=-1.25,Bn=-1.05,Ht=-.26,Bt=.24;for(let e=0;e<3;e++)Dt(Ht+e*Bt,Hn);for(let e=3;e<5;e++)Dt(Ht+(e-3)*Bt+.13,Bn);const C=N.children[0];C.material=Yt;const G=N.children[3];G.material=In;const E=N.children[1];E.material=jn;const R=N.children[4];R.material=Yn;const T=N.children[2];T.material=Dn;const qn=[C,G,E,R,T],l=new gn({oscillator:{type:"sawtooth"},filter:{type:"lowpass",frequency:2e3,rolloff:-12,Q:1},filterEnvelope:{attack:.1,decay:.2,sustain:.5,release:1,baseFrequency:200,octaves:3},envelope:{attack:.01,decay:.1,sustain:.9,release:.5}}).toDestination(),m=new yn().toDestination();l.volume.value=Me(0);l.oscillator.type="sine";l.envelope.attack=.05;l.envelope.sustain=.4;l.envelope.release=.2;m.envelope.attack=.05;m.envelope.sustain=.2;m.envelope.release=.2;window.addEventListener("click",()=>{fn(),console.log("Audio Context Started")});m.volume.value=Me(0);vn().start();const Xn=.5,_n=new bn(16777215,ee,Xn);r.add(_n);const k=new Pn;k.load("textures/stainedGlassA.png");k.load("textures/OceanWave.jpeg");const Nn=k.load("textures/stainedGlassWaveB.jpg");k.load("textures/stainedGlassD.jpg");k.load("textures/Greydient4A_silk_3.png");const qt=k.load("textures/Greydient4A_texture1_5.jpg"),Vn=k.load("textures/Greydient4B_texture1_6.jpg"),Zn=k.load("textures/Greydient4C_texture1_3.jpg");k.load("matcaps/0_export_2.png");const Kn=k.load("matcaps/0_export_6.png");k.load("matcaps/0_export_25.png");const $n=k.load("matcaps/export_92_blur.png"),xe=Math.PI*.12,Le=.3,ke=1.5,Ce=50,Ge=5,Ee=new M({map:Nn,color:16755268,emissive:16729344,emissiveIntensity:.5,transparent:!1,opacity:.7}),Xt=new M({color:b.neutraBeige,emissiveIntensity:.2,transparent:!1,opacity:1}),_t=new S(1,32,32),ht=0,Qn=0,gt=15,Nt=10,H=new D(ee,3);H.position.set(ht,Nt,gt);H.angle=xe;H.penumbra=Le;H.decay=ke;H.distance=Ce;H.intensity=Ge;r.add(H);const yt=new Se;yt.position.set(ht,Qn,gt);r.add(yt);H.target=yt;const Un=new S(1,32,32),$e=new p(Un,Ee);$e.position.set(ht,Nt,gt);r.add($e);const Re=0,Jn=0,ft=-5,Vt=10,B=new D(ee,3);B.position.set(Re,Vt,ft);B.angle=xe;B.penumbra=Le;B.decay=ke;B.distance=Ce;B.intensity=Ge;r.add(B);const vt=new Se;vt.position.set(Re,Jn,ft);r.add(vt);B.target=vt;const ei=new S(1,32,32),Zt=new p(ei,Ee);Zt.position.set(Re,Vt,ft);r.add(Zt);const bt=0,ti=0,Kt=-25,ni=10,q=new D(ee,3);q.position.set(bt,10,-25);q.angle=xe;q.penumbra=Le;q.decay=ke;q.distance=Ce;q.intensity=Ge;r.add(q);const Pt=new Se;Pt.position.set(bt,ti,Kt);r.add(Pt);q.target=Pt;const ii=new S(1,32,32),Mt=new p(ii,Ee);Mt.position.set(bt,ni,Kt);r.add(Mt);const F=new D(ee,3);F.position.set(0,10,-45);F.angle=xe;F.penumbra=Le;F.decay=ke;F.distance=Ce;F.intensity=Ge;r.add(F);const St=new Se;St.position.set(0,0,-45);r.add(St);F.target=St;const oi=new S(1,32,32),Q=new p(oi,Ee);Q.position.set(0,10,-45);r.add(Q);Q.visible=!1;const ue=new p(_t,Xt);ue.position.set(0,10,-45);r.add(ue);ue.visible=!0;F.intensity=0;const Z=new D(ee,3);Z.position.set(0,10,-65);Z.angle=xe;Z.penumbra=Le;Z.decay=ke;Z.distance=Ce;r.add(Z);const xt=new Se;xt.position.set(0,0,-65);r.add(xt);Z.target=xt;const Lt=new p(_t,Ee);Lt.position.set(0,10,-65);r.add(Lt);Z.visible=!0;Z.intensity=5;const A=new D(16755251,5);A.position.set(-3,6,20);A.angle=Math.PI/1.5;A.penumbra=.9;A.decay=.2;A.distance=20;A.castShadow=!0;A.shadow.mapSize.width=256;A.shadow.mapSize.height=256;A.intensity=.3;r.add(A);const O=new D(16755251,5);O.position.set(-3,6,0);O.angle=Math.PI/1.7;O.penumbra=.7;O.decay=.2;O.distance=20;O.castShadow=!0;O.shadow.mapSize.width=256;O.shadow.mapSize.height=256;O.intensity=.4;r.add(O);const z=new D(16755251,5);z.position.set(-3,6,-20);z.angle=Math.PI/1.5;z.penumbra=.9;z.decay=.2;z.distance=20;z.castShadow=!0;z.shadow.mapSize.width=256;z.shadow.mapSize.height=256;z.intensity=.3;r.add(z);const W=new D(16755251,5);W.position.set(-3,6,-45);W.angle=Math.PI/1.5;W.penumbra=.9;W.decay=.2;W.distance=20;W.castShadow=!0;W.shadow.mapSize.width=256;W.shadow.mapSize.height=256;W.intensity=.3;r.add(W);const I=new D(16755251,5);I.position.set(-3,6,-64);I.angle=Math.PI/1.5;I.penumbra=.9;I.decay=.2;I.distance=20;I.castShadow=!0;I.shadow.mapSize.width=256;I.shadow.mapSize.height=256;I.intensity=.3;r.add(I);const ai=new U(b.terracotta).lerp(new U(8421504),.001);r.fog=new Mn(ai,20,70);const si=new U(f).lerp(new U(8421504),.2);r.fog=new Sn(si,.01);const j=new M({color:te});j.roughness=.4;j.metalness=.1;const Qe=new Wt({color:b.terracotta});Qe.matcap=Kn;Qe.roughness=.4;Qe.metalness=.1;const kt=new Wt({color:ee});kt.matcap=$n;kt.roughness=.9;kt.metalness=.1;const Ft=10,ri=150,$t=new It(Ft,Ft,ri,32,16,!1);$t.computeVertexNormals();const De=new ce({map:qt,color:b.terracotta,side:xn}),Te=new p($t,De);Te.rotation.x=Math.PI/2;Te.position.z=-20;Te.receiveShadow=!0;Te.castShadow=!0;r.add(Te);function Qt(e,t,n,i,o,a){const h=new Ze,u=1e-5,g=e/a;h.moveTo(-e/2,0);for(let w=0;w<=a;w++){const _=-e/2+w*g,L=Math.sin(w/a*Math.PI*2)*(t/2);w===0?h.lineTo(_,L):h.quadraticCurveTo(_-g/2,L,_,L)}for(let w=a;w>=0;w--){const _=-e/2+w*g,L=Math.sin(w/a*Math.PI*2)*(t/2);h.lineTo(_,L+u)}const x={steps:1,depth:n,bevelEnabled:!0,bevelThickness:i,bevelSize:i,bevelSegments:4},X=new Ke(h,x);return X.center(),X}const Ut=1.33,Fe=.665,Jt=.266,en=.0665,ci=Qt(Ut,Fe,Jt,en,16,64),pe=new p(ci,j);pe.visible=!0;function tn(e,t,n,i,o){const a=new Ze,u=i-1e-5;a.moveTo(0,u),a.lineTo(0,t-u),a.quadraticCurveTo(0,t,u,t),a.lineTo(e-u,t),a.quadraticCurveTo(e,t,e,t-u),a.lineTo(e,u),a.quadraticCurveTo(e,0,e-u,0),a.lineTo(u,0),a.quadraticCurveTo(0,0,0,u);const g=new Ke(a,{depth:n-i*2,bevelEnabled:!0,bevelSegments:o*2,steps:1,bevelSize:i,bevelThickness:i,curveSegments:o});return g.center(),g}const li=tn(.8,.8,.8,.05,16),me=new p(li,j);me.visible=!1;function nn(e,t,n,i,o){const a=new Ze,u=i-1e-5,g=e/2;a.moveTo(-g+u,-t/2),a.lineTo(g-u,-t/2),a.quadraticCurveTo(g,-t/2,g,-t/2+u),a.lineTo(u,t/2-u),a.quadraticCurveTo(0,t/2,-u,t/2-u),a.lineTo(-g,-t/2+u),a.quadraticCurveTo(-g,-t/2,-g+u,-t/2);const x={steps:1,depth:n,bevelEnabled:!0,bevelThickness:i,bevelSize:i,bevelSegments:o},X=new Ke(a,x);return X.center(),X}const di=nn(1,.866,.2,.05,4),we=new p(di,j);we.visible=!1;const le=new P;le.add(pe);le.add(me);le.add(we);le.position.set(0,0,15);r.add(le);const ui=16,pi=64,mi=1,wi=.866,hi=.2,gi=.05,yi=4,Ct=new M({color:te,opacity:.5,transparent:!0,roughness:.5,metalness:.1}),fi=Qt(Ut/3,Fe/3,Jt/3,en/3,ui,pi),Ae=new p(fi,Ct);Ae.position.set(0,Fe/2+.65,15);r.add(Ae);const vi=nn(mi/3,wi/3,hi/3,gi/3,yi),Oe=new p(vi,Ct),bi=tn(.8/3,.8/3,.8/3,.05/3,16),ze=new p(bi,Ct);r.add(Oe,ze);const Pi=.7;Oe.position.set(-.7,Fe/2+.5,15);ze.position.set(Pi,Fe/2+.5,15);Ae.visible=!0;Oe.visible=!0;ze.visible=!0;const We=new P;We.add(Ae);We.add(Oe);We.add(ze);r.add(We);let At="sine";const d=new An,s=new On,Ot=[{mesh:Ae,shape:"sine"},{mesh:Oe,shape:"pyramid"},{mesh:ze,shape:"cube"}];window.addEventListener("click",e=>{var n;s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(s,c);const t=d.intersectObjects([...Ot.map(i=>i.mesh),$e]);if(t.length>0){const i=t[0].object,o=(n=Ot.find(a=>a.mesh===i))==null?void 0:n.shape;o&&Mi(o)}});function Mi(e){e!==At&&(pe.visible=e==="sine",we.visible=e==="pyramid",me.visible=e==="cube",e==="sine"?(pe.visible=!0,De.map=qt,l.oscillator.type="sine"):e==="pyramid"?(we.visible=!0,De.map=Vn,l.oscillator.type="triangle"):e==="cube"&&(me.visible=!0,De.map=Zn,l.oscillator.type="square"),At=e)}const Si=.15;l.volume.value=Me(Si);const Ie=new P;r.add(Ie);const He=7,rt=.2,xi=.05,Li=new M({color:te,transparent:!0,opacity:.3,roughness:.5,metalness:.1});for(let e=0;e<He;e++){const t=new S(xi,16,16),n=new p(t,Li.clone());n.position.set(1.5,e*rt,15),Ie.add(n)}let $=null;window.addEventListener("mousedown",e=>{s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(s,c);const t=d.intersectObjects(Ie.children);t.length>0&&($=t[0].object,$.scale.set(2,2,2))});H.intensity=1;window.addEventListener("mousemove",e=>{if($){s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(s,c);const t=new J(new v(0,0,1),-$.position.z),n=new v;d.ray.intersectPlane(t,n);const i=V.clamp(n.y,0,He*rt);$.position.y=i;const o=i/(He*rt);on(o*100),l.volume.value=Me(o);const a=o*5;H.intensity=a,$.visible=!0}});window.addEventListener("mouseup",()=>{$=null});function on(e){const t=Math.round(e/100*He);Ie.children.forEach((n,i)=>{n.material.opacity=i<t?1:.3})}on(15);const Ue=new P;Ue.add(le);Ue.add(We);Ue.add(Ie);r.add(Ue);const ki=Re,Ci=0,Gi=-5,he=new P;r.add(he);new Ln({color:te,transparent:!0,opacity:.5});const Ei=new jt(.02,.02,.02);function Ri(e){const t=new p(Ei,Xt),n=4,i=Math.random()*Math.PI*5,o=Math.acos(2*Math.random()-1);return t.position.set(n*Math.sin(o)*Math.cos(i),n*Math.sin(o)*Math.sin(i),n*Math.cos(o)),t.velocity=new v((Math.random()-.5)*.01,(Math.random()-.5)*.01,(Math.random()-.5)*.01),t}function an(e,t){he.clear();for(let n=0;n<e;n++)he.add(Ri());console.log("Sending grain count to backend:",e)}he.position.set(ki,Ci,Gi);an(500);const Je=new P;r.add(Je);const Be=7,ct=.2,Ti=.05,Fi=new M({color:te,transparent:!0,opacity:.3,roughness:.5,metalness:.1});for(let e=0;e<Be;e++){const t=new S(Ti,16,16),n=new p(t,Fi.clone());n.position.set(Re+2.5,e*ct,-5),Je.add(n)}let ne=null;window.addEventListener("mousedown",e=>{s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(s,c);const t=d.intersectObjects(Je.children);t.length>0&&(ne=t[0].object,ne.scale.set(2,2,2))});B.intensity=1;window.addEventListener("mousemove",e=>{if(ne){s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(s,c);const t=new J(new v(0,0,1),-ne.position.z),n=new v;d.ray.intersectPlane(t,n);const i=V.clamp(n.y,0,Be*ct);ne.position.y=i;const o=i/(Be*ct);m.volume.value=Me(o),an(o*500),Ai(o*100);const a=o*5;B.intensity=a}});window.addEventListener("mouseup",()=>{ne=null});function Ai(e){const t=Math.round(e/100*Be);Je.children.forEach((n,i)=>{n.material.opacity=i<t?1:.3})}function Oi(e,t,n,i,o){const a=new P,h=new Ze;h.moveTo(-2.5/2,0),h.lineTo(e/2,0);const u=V.degToRad(o),g=Math.cos(u)*t,x=-Math.sin(u)*t;h.lineTo(e/2+g,x),h.quadraticCurveTo(e/2,0,-2.5/2,.2);const X={steps:10,depth:n,bevelEnabled:!0,bevelThickness:i*3,bevelSize:i,bevelSegments:32},w=new Ke(h,X);w.center();const _=new p(w,j);return a.add(_),a}const zi=2.5,Wi=2,Ii=.1,ji=.2,Yi=30,sn=Oi(zi,Wi,Ii,ji,Yi);sn.position.set(0,0,-26);r.add(sn);const et=new P;r.add(et);const qe=7,lt=.2,Di=.05,Hi=new M({color:te,transparent:!0,opacity:.3,roughness:.5,metalness:.1});for(let e=0;e<qe;e++){const t=new S(Di,16,16),n=new p(t,Hi.clone());n.position.set(1.5,e*lt,-25),et.add(n)}let ie=null;window.addEventListener("mousedown",e=>{s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(s,c);const t=d.intersectObjects(et.children);t.length>0&&(ie=t[0].object,ie.scale.set(2,2,2))});q.intensity=1;window.addEventListener("mousemove",e=>{if(ie){s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(s,c);const t=new J(new v(0,0,1),-ie.position.z),n=new v;d.ray.intersectPlane(t,n);const i=V.clamp(n.y,0,qe*lt);ie.position.y=i;const o=i/(qe*lt);Bi(o*100);const a=o*5;q.intensity=a}});window.addEventListener("mouseup",()=>{ie=null});function Bi(e){const t=Math.round(e/100*qe);et.children.forEach((n,i)=>{n.material.opacity=i<t?1:.3})}const tt=new P,qi=25,Xi=1.5;for(let e=0;e<qi;e++){const t=Xi+(Math.random()-.5)*.1,n=Math.random()*Math.PI*2;let i;const o=Math.random();o<.33?i=new S(.05*Math.random()+.03,8,8):o<.66?i=new jt(.05*Math.random()+.03,.05*Math.random()+.03,.05*Math.random()+.03):i=new kn(.05*Math.random()+.03,0);const a=new p(i,j);a.position.set(t*Math.cos(n),t*Math.sin(n),0),a.rotation.set(Math.random()*Math.PI,Math.random()*Math.PI,Math.random()*Math.PI),a.userData={initialPosition:a.position.clone(),scale:1},tt.add(a)}tt.position.set(0,0,-45);r.add(tt);const _i=new It(2,2,.1,32),Ni=new M({opacity:0,transparent:!0}),rn=new p(_i,Ni);rn.rotation.x=Math.PI/2;rn.position.z=-45;function Vi(){const e=Date.now()*.001;tt.children.forEach(t=>{const{initialPosition:n,scale:i}=t.userData;t.position.x=n.x+Math.sin(e+t.id)*.1,t.position.y=n.y+Math.cos(e+t.id)*.1,t.scale.set(i,i,i)})}const Zi=new Cn;Zi.load("fonts/P22 FLLW Exhibition_Regular.json",function(e){function t(mn,wn){return new zn(mn,{font:wn,size:11,height:2,curveSegments:12,bevelEnabled:!0,bevelThickness:.1,bevelSize:.5,bevelOffset:0,bevelSegments:5})}const n=t("A",e);t("D",e),t("S",e),t("R",e),new Gn,new p(n,Qe);const i=.08,o=t("OSC",e),a=new p(o,de);a.position.set(-2.7,8,18.4),a.scale.set(i,i,i),a.rotation.x=Math.PI/2,a.castShadow=!0,a.receiveShadow=!0,a.transparent=!0,r.add(a),A.target=$e;const h=t("Noise",e),u=new p(h,de);u.position.set(-3.2,8,-1.6),u.scale.set(i,i,i),u.rotation.x=Math.PI/2,u.castShadow=!0,u.transparent=!0,r.add(u),O.target=u;const g=t("Filter",e),x=new p(g,de);x.position.set(-2.9,8,-21.6),x.scale.set(i,i,i),x.rotation.x=Math.PI/2,x.castShadow=!0,x.transparent=!0,r.add(x),z.target=Mt;const X=t("LFO",e),w=new p(X,de);w.position.set(-2.8,7.5,-44.3),w.scale.set(i,i,i),w.rotation.x=Math.PI/2,w.castShadow=!0,w.transparent=!0,r.add(w),W.target=Q;const _=t("adsr",e),L=new p(_,de);L.position.set(-3.5,7.7,-63.7),L.scale.set(i,i,i),L.rotation.x=Math.PI/2,L.castShadow=!0,L.transparent=!0,r.add(L),I.target=Lt});const nt=new P;r.add(nt);const Xe=10,dt=.2,Ki=.05,$i=new M({color:j,transparent:!0,opacity:.3,roughness:.5,metalness:.1});for(let e=0;e<Xe;e++){const t=new S(Ki,16,16),n=new p(t,$i.clone());n.position.set(-3,e*dt,-65),nt.add(n)}let oe=null;window.addEventListener("mousedown",e=>{s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(s,c);const t=d.intersectObjects(nt.children);t.length>0&&(oe=t[0].object,oe.scale.set(2,2,2))});window.addEventListener("mousemove",e=>{if(oe){s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(s,c);const t=new J(new v(0,0,1),-oe.position.z),n=new v;d.ray.intersectPlane(t,n);const i=V.clamp(n.y,0,Xe*dt);oe.position.y=i;const o=i/(Xe*dt);console.log(`Volume Level: ${o.toFixed(2)}`),l.envelope.attack=o,m.envelope.attack=o,cn(o*100)}});window.addEventListener("mouseup",()=>{oe=null});function cn(e){const t=Math.round(e/100*Xe);nt.children.forEach((n,i)=>{i<t?n.material.opacity=1:n.material.opacity=.3})}cn(10);const it=new P;r.add(it);const _e=10,ut=.2,Qi=.05,Ui=new M({color:j,transparent:!0,opacity:.3,roughness:.5,metalness:.1});for(let e=0;e<_e;e++){const t=new S(Qi,16,16),n=new p(t,Ui.clone());n.position.set(-1,e*ut,-65),it.add(n)}let ae=null;window.addEventListener("mousedown",e=>{s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(s,c);const t=d.intersectObjects(it.children);t.length>0&&(ae=t[0].object,ae.scale.set(2,2,2))});window.addEventListener("mousemove",e=>{if(ae){s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(s,c);const t=new J(new v(0,0,1),-ae.position.z),n=new v;d.ray.intersectPlane(t,n);const i=V.clamp(n.y,0,_e*ut);ae.position.y=i;const o=i/(_e*ut);l.envelope.decay=o,m.envelope.decay=o,console.log(`Decay Level: ${o.toFixed(2)}`),ln(o*100)}});window.addEventListener("mouseup",()=>{ae=null});function ln(e){const t=Math.round(e/100*_e);it.children.forEach((n,i)=>{i<t?n.material.opacity=1:n.material.opacity=.3})}ln(10);const ot=new P;r.add(ot);const Ne=10,pt=.2,Ji=.05,eo=new M({color:j,transparent:!0,opacity:.3,roughness:.5,metalness:.1});for(let e=0;e<Ne;e++){const t=new S(Ji,16,16),n=new p(t,eo.clone());n.position.set(1,e*pt,-65),ot.add(n)}let se=null;window.addEventListener("mousedown",e=>{s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(s,c);const t=d.intersectObjects(ot.children);t.length>0&&(se=t[0].object,se.scale.set(2,2,2))});window.addEventListener("mousemove",e=>{if(se){s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(s,c);const t=new J(new v(0,0,1),-se.position.z),n=new v;d.ray.intersectPlane(t,n);const i=V.clamp(n.y,0,Ne*pt);se.position.y=i;const o=i/(Ne*pt);l.envelope.sustain=o,m.envelope.sustain=o,dn(o*100)}});window.addEventListener("mouseup",()=>{se=null});function dn(e){const t=Math.round(e/100*Ne);ot.children.forEach((n,i)=>{i<t?n.material.opacity=1:n.material.opacity=.3})}dn(10);const at=new P;r.add(at);const Ve=10,mt=.2,to=.05,no=new M({color:j,transparent:!0,opacity:.3,roughness:.5,metalness:.1});for(let e=0;e<Ve;e++){const t=new S(to,16,16),n=new p(t,no.clone());n.position.set(3,e*mt,-65),at.add(n)}let re=null;window.addEventListener("mousedown",e=>{s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(s,c);const t=d.intersectObjects(at.children);t.length>0&&(re=t[0].object,re.scale.set(2,2,2))});window.addEventListener("mousemove",e=>{if(re){s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(s,c);const t=new J(new v(0,0,1),-re.position.z),n=new v;d.ray.intersectPlane(t,n);const i=V.clamp(n.y,0,Ve*mt);re.position.y=i;const o=i/(Ve*mt);l.envelope.release=o,m.envelope.release=o,un(o*100)}});window.addEventListener("mouseup",()=>{re=null});function un(e){const t=Math.round(e/100*Ve);at.children.forEach((n,i)=>{i<t?n.material.opacity=1:n.material.opacity=.3})}un(10);const c=new En(75,Y.width/Y.height);c.position.set(0,0,45);r.add(c);const K=new Rn({canvas:Wn,antialias:!0});K.setSize(Y.width,Y.height);K.shadowMap.enabled=!0;K.shadowMap.type=Tn;K.setPixelRatio(Math.min(window.devicePixelRatio,1));K.setPixelRatio(Math.min(window.devicePixelRatio,1));let Gt=!1,Et=!1,Rt=!1,Tt=!1;const io=.2,zt=.02;window.addEventListener("keydown",e=>{switch(e.preventDefault(),e.key.toLowerCase()){case"w":Gt=!0,y=0;break;case"s":Et=!0,y=0;break;case"a":Rt=!0,y=0;break;case"d":Tt=!0,y=0;break}});window.addEventListener("keyup",e=>{switch(e.key.toLowerCase()){case"w":Gt=!1;break;case"s":Et=!1;break;case"a":Rt=!1;break;case"d":Tt=!1;break}});let ge=!1,ye=!1,fe=!1,ve=!1,be=!1;window.addEventListener("mousedown",e=>{s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(s,c);const t=d.intersectObjects(qn);if(t.length>0){je=!0;const n=t[0].object;n===C?(ge=!0,l.triggerAttack("D3"),m.triggerAttack(),y=.2,C.material.color.set(b.paleSkyBlue),C.material.opacity=.9):n===G?(ye=!0,l.triggerAttack("F#3"),m.triggerAttack(),y=.3,G.material.color.set(b.paleSkyBlue),G.material.opacity=.9):n===E?(fe=!0,l.triggerAttack("G3"),m.triggerAttack(),y=.5,E.material.color.set(b.paleSkyBlue),E.material.opacity=.9):n===R?(ve=!0,l.triggerAttack("A3"),m.triggerAttack(),y=.6,R.material.color.set(b.paleSkyBlue),R.material.opacity=.9):n===T&&(be=!0,l.triggerAttack("C4"),m.triggerAttack(),y=.8,T.material.color.set(b.paleSkyBlue),T.material.opacity=.9)}});window.addEventListener("mouseup",e=>{je=!1,ge?(l.triggerRelease(),m.triggerRelease(),C.material.color.set(f),C.material.opacity=.25,ge=!1):ye?(l.triggerRelease(),m.triggerRelease(),G.material.color.set(f),G.material.opacity=.25,ye=!1):fe?(l.triggerRelease(),m.triggerRelease(),E.material.color.set(f),E.material.opacity=.25,fe=!1):ve?(l.triggerRelease(),m.triggerRelease(),R.material.color.set(f),R.material.opacity=.25,ve=!1):be&&(l.triggerRelease(),m.triggerRelease(),T.material.color.set(f),T.material.opacity=.25,be=!1)});let wt=null;window.addEventListener("keydown",e=>{e.preventDefault();const t=e.key.toLowerCase();if(wt!==t)switch(wt=t,je=!0,e.key.toLowerCase()){case"j":ge=!0,l.triggerAttack("D3"),m.triggerAttack(),y=.2,C.material.color.set(b.paleSkyBlue),C.material.opacity=.9;break;case"k":fe=!0,l.triggerAttack("G3"),m.triggerAttack(),y=.5,E.material.color.set(b.paleSkyBlue),E.material.opacity=.9;break;case"l":be=!0,l.triggerAttack("C4"),m.triggerAttack(),y=.8,T.material.color.set(b.paleSkyBlue),T.material.opacity=.9;break;case"i":ye=!0,l.triggerAttack("F#3"),m.triggerAttack(),y=.3,G.material.color.set(b.paleSkyBlue),G.material.opacity=.9;break;case"o":ve=!0,l.triggerAttack("A3"),m.triggerAttack(),y=.6,R.material.color.set(b.paleSkyBlue),R.material.opacity=.9}});window.addEventListener("keyup",e=>{switch(je=!1,wt=null,e.key.toLowerCase()){case"j":l.triggerRelease(),m.triggerRelease(),C.material.color.set(f),C.material.opacity=.25,ge=!1;break;case"k":l.triggerRelease(),m.triggerRelease(),E.material.color.set(f),E.material.opacity=.25,fe=!1;break;case"l":l.triggerRelease(),m.triggerRelease(),T.material.color.set(f),T.material.opacity=.25,be=!1;break;case"i":l.triggerRelease(),m.triggerRelease(),G.material.color.set(f),G.material.opacity=.25,ye=!1;break;case"o":l.triggerRelease(),m.triggerRelease(),R.material.color.set(f),R.material.opacity=.25,ve=!1;break}});let st=!1;window.addEventListener("click",e=>{s.x=e.clientX/window.innerWidth*2-1,s.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(s,c),d.intersectObject(Q).length>0&&(Q.visible=!Q.visible,ue.visible=!ue.visible,st?(F.intensity=0,st=!1):(F.intensity=Ge,st=!0))});let y=.5,je=!1;const Ye={minZ:-85,maxZ:45,radius:9.5};function pn(){requestAnimationFrame(pn),Vi(),N.position.copy(c.position),N.quaternion.copy(c.quaternion),Rt&&(c.rotation.y+=zt),Tt&&(c.rotation.y-=zt);const e=new v;c.getWorldDirection(e),Gt&&c.position.add(e.multiplyScalar(io)),Et&&c.position.add(e.multiplyScalar(-.2)),c.position.z=V.clamp(c.position.z,Ye.minZ,Ye.maxZ);const t=Math.sqrt(c.position.x**2+c.position.y**2);if(t>Ye.radius){const n=Ye.radius/t;c.position.x*=n,c.position.y*=n}he.children.forEach(n=>{n.position.add(n.velocity);const i=1.25;n.position.length()>i&&(n.position.normalize().multiplyScalar(i),n.velocity.negate()),n.material.opacity=3}),je&&(pe.rotation.y+=y,we.rotation.y+=y,me.rotation.y+=y),K.render(r,c)}pn();window.addEventListener("resize",()=>{Y.width=window.innerWidth,Y.height=window.innerHeight,c.aspect=Y.width/Y.height,c.updateProjectionMatrix(),K.setSize(Y.width,Y.height),K.setPixelRatio(Math.min(window.devicePixelRatio,2))});
