import{S as Gn,P as Fn,W as En,a as kn,V as Rn,R as On,M as Tn,s as _e,N as Hn,g as me,F as zn,b as In,C as _,T as Wn,c as Yt,d as le,B as An,e as u,f as g,D as ye,h as jt,G as f,i as Dn,H as Yn,j as v,k as O,O as fe,l as $e,E as Ke,m as jn,n as Nn,o as N,p as y,q as T,r as qn,t as Nt,I as Bn,u as Xn,v as _n,w as $n,x as Kn}from"./vendor-CztYBbk_.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const h of i.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&o(h)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();const r=new Gn,Vn=document.querySelector("canvas.webgl"),a=new Rn,d=new On,k={width:window.innerWidth,height:window.innerHeight},l=new Fn(75,k.width/k.height);l.position.set(0,0,45);const $=new En({canvas:Vn,antialias:!0});$.setSize(k.width,k.height);$.shadowMap.enabled=!0;$.shadowMap.type=kn;$.setPixelRatio(Math.min(window.devicePixelRatio,2));window.addEventListener("resize",()=>{k.width=window.innerWidth,k.height=window.innerHeight,l.aspect=k.width/k.height,l.updateProjectionMatrix(),$.setSize(k.width,k.height),$.setPixelRatio(Math.min(window.devicePixelRatio,2))});const p=new Tn({oscillator:{type:"sawtooth"},envelope:{attack:.01,decay:.1,sustain:.9,release:.5}});_e();const x=new Hn;p.volume.value=me(0);p.oscillator.type="sine";p.envelope.attack=.05;p.envelope.sustain=.4;p.envelope.release=.2;x.envelope.attack=.05;x.envelope.sustain=.2;x.envelope.release=.2;window.addEventListener("click",()=>{_e(),console.log("Audio Context Started")});p.filter.frequency.value=0;const q=new zn({type:"lowpass",frequency:2e4,rolloff:-24,Q:1}).toDestination();p.filterEnvelope.attack=0;p.filterEnvelope.decay=0;p.filterEnvelope.sustain=0;p.filterEnvelope.release=0;p.connect(q);x.connect(q);q.attack=0;q.decay=0;q.sustain=0;q.release=0;x.volume.value=me(0);window.addEventListener("keydown",async()=>{await _e()});window.addEventListener("click",async()=>{await _e(),console.log("Audio Context Started")});In().start();const K=new _(13145664),V=new _(16746496),Z=new _(33413),R={neutraBeige:"#D9D4C5",sageGreen:"#A8B79A",warmGray:"#A9A39B",terracotta:"#C67650",paleSkyBlue:"#9EB8C2",oliveBrown:"#5A5A44",sunlitSand:"#E5C69F",mutedTeal:"#6E8D90",charcoalGray:"#4A4A4A"},Zn=new _(R.terracotta).lerp(new _(8421504),.001),Un=new _(Z).lerp(new _(8421504),.2),M=new Wn;M.load("textures/stainedGlassA.png");M.load("textures/OceanWave.jpeg");const qt=M.load("textures/stainedGlassWaveB.jpg");M.load("textures/stainedGlassD.jpg");M.load("textures/Greydient4A_silk_3.png");const Bt=M.load("textures/Greydient4A_texture1_5.jpg"),Qn=M.load("textures/Greydient4B_texture1_6.jpg"),Jn=M.load("textures/Greydient4C_texture1_3.jpg");M.load("matcaps/0_export_2.png");const eo=M.load("matcaps/0_export_6.png");M.load("matcaps/0_export_25.png");const to=M.load("matcaps/export_92_blur.png"),It=10,no=150,Xt=new Yt(It,It,no,32,16,!1);Xt.computeVertexNormals();const He=new le({map:Bt,color:R.terracotta,side:An}),ge=new u(Xt,He);ge.rotation.x=Math.PI/2;ge.position.z=-20;ge.receiveShadow=!0;ge.castShadow=!0;const ue=new g({color:V,opacity:0,transparent:!0,roughness:.5,metalness:.1}),_t=new le({color:Z,emissive:4521796,emissiveIntensity:.9,transparent:!0,opacity:.25,side:ye}),oo=new le({color:Z,emissive:4521796,emissiveIntensity:.9,transparent:!0,opacity:.25,side:ye}),so=new le({color:Z,emissive:4521796,emissiveIntensity:.9,transparent:!0,opacity:.25,side:ye}),io=new le({color:Z,emissive:4521796,emissiveIntensity:.9,transparent:!0,opacity:.25,side:ye}),ao=new le({color:Z,emissive:4521796,emissiveIntensity:.9,transparent:!0,opacity:.25,side:ye});new g({map:qt,color:16755268,emissive:16729344,emissiveIntensity:.5,transparent:!1,opacity:.7});const ro=new g({color:R.neutraBeige,emissiveIntensity:.2,transparent:!1,opacity:1}),gt=new g({color:V,opacity:.5,transparent:!0,roughness:.5,metalness:.1}),L=new g({color:V});L.roughness=.4;L.metalness=.1;const Ve=new jt({color:R.terracotta});Ve.matcap=eo;Ve.roughness=.4;Ve.metalness=.1;const vt=new jt({color:K});vt.matcap=to;vt.roughness=.9;vt.metalness=.1;const Y=new f;function $t(e,t,n){const o=new Dn(.5,32),s=new u(o,_t);s.position.set(e,t,-2),s.scale.set(.2,.2,.2),Y.add(s)}const co=-1.25,lo=-1.05,Kt=-.26,Vt=.24;for(let e=0;e<3;e++)$t(Kt+e*Vt,co);for(let e=3;e<5;e++)$t(Kt+(e-3)*Vt+.125,lo);const U=Y.children[0];U.material=_t;const Q=Y.children[3];Q.material=oo;const J=Y.children[1];J.material=so;const ee=Y.children[4];ee.material=io;const te=Y.children[2];te.material=ao;const uo=.5,ho=new Yn(16777215,K,uo),ve=new g({map:qt,color:16755268,emissive:16729344,emissiveIntensity:.5,transparent:!1,opacity:.7}),wo=new g({color:R.neutraBeige,emissiveIntensity:.2,transparent:!1,opacity:1}),Zt=new v(1,32,32),be=Math.PI*.12,Pe=.3,Me=1.5,Se=50,Ze=5,bt=0,po=0,Pt=15,Ut=10,H=new O(K,3);H.position.set(bt,Ut,Pt);H.angle=be;H.penumbra=Pe;H.decay=Me;H.distance=Se;H.intensity=Ze;const Mt=new fe;Mt.position.set(bt,po,Pt);H.target=Mt;const mo=new v(1,32,32),Ue=new u(mo,ve);Ue.position.set(bt,Ut,Pt);const St=0,yo=0,xt=-5,Qt=10,z=new O(K,3);z.position.set(St,Qt,xt);z.angle=be;z.penumbra=Pe;z.decay=Me;z.distance=Se;z.intensity=Ze;const Lt=new fe;Lt.position.set(St,yo,xt);z.target=Lt;const fo=new v(1,32,32),Jt=new u(fo,ve);Jt.position.set(St,Qt,xt);const Ct=0,go=0,en=-25,vo=10,I=new O(K,3);I.position.set(Ct,10,-25);I.angle=be;I.penumbra=Pe;I.decay=Me;I.distance=Se;I.intensity=Ze;const Gt=new fe;Gt.position.set(Ct,go,en);I.target=Gt;const bo=new v(1,32,32),Ft=new u(bo,ve);Ft.position.set(Ct,vo,en);const S=new O(K,3);S.position.set(0,10,-45);S.angle=be;S.penumbra=Pe;S.decay=Me;S.distance=Se;S.intensity=Ze;const Et=new fe;Et.position.set(0,0,-45);S.target=Et;const Po=new v(1,32,32),X=new u(Po,ve);X.position.set(0,10,-45);X.visible=!1;const he=new u(Zt,wo);he.position.set(0,10,-45);he.visible=!0;S.intensity=0;const j=new O(K,3);j.position.set(0,10,-65);j.angle=be;j.penumbra=Pe;j.decay=Me;j.distance=Se;const kt=new fe;kt.position.set(0,0,-65);j.target=kt;const Rt=new u(Zt,ve);Rt.position.set(0,10,-65);j.visible=!0;j.intensity=5;const W=new O(16755251,.5);W.position.set(-3,6,20);W.angle=Math.PI/1.5;W.penumbra=.9;W.decay=.2;W.distance=20;W.castShadow=!0;W.shadow.mapSize.width=256;W.shadow.mapSize.height=256;const C=new O(16755251,5);C.position.set(-3,6,0);C.angle=Math.PI/1.7;C.penumbra=.7;C.decay=.2;C.distance=20;C.castShadow=!0;C.shadow.mapSize.width=256;C.shadow.mapSize.height=256;C.intensity=.4;const G=new O(16755251,5);G.position.set(-3,6,-20);G.angle=Math.PI/1.5;G.penumbra=.9;G.decay=.2;G.distance=20;G.castShadow=!0;G.shadow.mapSize.width=256;G.shadow.mapSize.height=256;G.intensity=.3;const F=new O(16755251,5);F.position.set(-3,6,-45);F.angle=Math.PI/1.5;F.penumbra=.9;F.decay=.2;F.distance=20;F.castShadow=!0;F.shadow.mapSize.width=256;F.shadow.mapSize.height=256;F.intensity=.3;const E=new O(16755251,5);E.position.set(-3,6,-64);E.angle=Math.PI/1.5;E.penumbra=.9;E.decay=.2;E.distance=20;E.castShadow=!0;E.shadow.mapSize.width=256;E.shadow.mapSize.height=256;E.intensity=.3;function tn(e,t,n,o,s,i){const h=new $e,c=1e-5,w=e/i;h.moveTo(-e/2,0);for(let m=0;m<=i;m++){const D=-e/2+m*w,P=Math.sin(m/i*Math.PI*2)*(t/2);m===0?h.lineTo(D,P):h.quadraticCurveTo(D-w/2,P,D,P)}for(let m=i;m>=0;m--){const D=-e/2+m*w,P=Math.sin(m/i*Math.PI*2)*(t/2);h.lineTo(D,P+c)}const b={steps:1,depth:n,bevelEnabled:!0,bevelThickness:o,bevelSize:o,bevelSegments:4},A=new Ke(h,b);return A.center(),A}const nn=1.33,xe=.665,on=.266,sn=.0665,Mo=tn(nn,xe,on,sn,16,64),ze=new u(Mo,L);ze.visible=!0;function an(e,t,n,o,s){const i=new $e,c=o-1e-5;i.moveTo(0,c),i.lineTo(0,t-c),i.quadraticCurveTo(0,t,c,t),i.lineTo(e-c,t),i.quadraticCurveTo(e,t,e,t-c),i.lineTo(e,c),i.quadraticCurveTo(e,0,e-c,0),i.lineTo(c,0),i.quadraticCurveTo(0,0,0,c);const w=new Ke(i,{depth:n-o*2,bevelEnabled:!0,bevelSegments:s*2,steps:1,bevelSize:o,bevelThickness:o,curveSegments:s});return w.center(),w}const So=an(.8,.8,.8,.05,16),Ie=new u(So,L);Ie.visible=!1;function Qe(e,t,n,o,s){const i=new $e,c=o-1e-5,w=e/2;i.moveTo(-w+c,-t/2),i.lineTo(w-c,-t/2),i.quadraticCurveTo(w,-t/2,w,-t/2+c),i.lineTo(c,t/2-c),i.quadraticCurveTo(0,t/2,-c,t/2-c),i.lineTo(-w,-t/2+c),i.quadraticCurveTo(-w,-t/2,-w+c,-t/2);const b={steps:1,depth:n,bevelEnabled:!0,bevelThickness:o,bevelSize:o,bevelSegments:s},A=new Ke(i,b);return A.center(),A}const xo=Qe(1,.866,.2,.05,4),We=new u(xo,L);We.visible=!1;class Lo{constructor(t,n,o,s,i,h,c){this.raycaster=t,this.camera=n,this.rings=o,this.synth=s,this.noise=i,this.colorPalette=h,this.tunnelColor=c,this.mouse=a,this.isHoldingRootRing=!1,this.isHoldingThirdRing=!1,this.isHoldingFourth=!1,this.isHoldingFifth=!1,this.isHoldingSeventh=!1,this.isNoteOn=!1,this.octaveOffset=0,this.activeKey=null,this.initListeners()}initListeners(){window.addEventListener("mousedown",t=>this.handleMouseDown(t)),window.addEventListener("mouseup",t=>this.handleMouseUp(t)),window.addEventListener("keydown",t=>this.handleKeyDown(t)),window.addEventListener("keyup",t=>this.handleKeyUp(t))}handleMouseDown(t){this.mouse.x=t.clientX/window.innerWidth*2-1,this.mouse.y=-(t.clientY/window.innerHeight)*2+1,this.raycaster.setFromCamera(this.mouse,this.camera);const n=this.raycaster.intersectObjects(this.rings);if(n.length>0){this.isNoteOn=!0;const o=n[0].object;o===U?(this.isHoldingRootRing=!0,this.playNote("D3",U,.2)):o===Q?(this.isHoldingThirdRing=!0,this.playNote("F#3",Q,.3)):o===J?(this.isHoldingFourth=!0,this.playNote("G3",J,.5)):o===ee?(this.isHoldingFifth=!0,this.playNote("A3",ee,.6)):o===te&&(this.isHoldingSeventh=!0,this.playNote("C4",te,.8))}}handleMouseUp(){this.isNoteOn=!1,this.releaseNote()}handleKeyDown(t){t.preventDefault();const n=t.key;if(this.activeKey!=n)switch(this.activeKey=n,this.isNoteOn=!0,n){case"j":this.isHoldingRootRing=!0,this.playNote("D3",U,.2);break;case"k":this.isHoldingFourth=!0,this.playNote("G3",J,.5);break;case"l":this.isHoldingSeventh=!0,this.playNote("C4",te,.8);break;case"i":this.isHoldingThirdRing=!0,this.playNote("F#3",Q,.3);break;case"o":this.isHoldingFifth=!0,this.playNote("A3",ee,.6);break;case"ArrowLeft":this.octaveOffset=Math.max(this.octaveOffset-1,-2),console.log(`Octave: ${this.octaveOffset}`);break;case"ArrowRight":this.octaveOffset=Math.min(this.octaveOffset+1,2),console.log(`Octave: ${this.octaveOffset}`);break}}handleKeyUp(){this.isNoteOn=!1,this.activeKey=null,this.releaseNote()}playNote(t,n,o){const s=t.slice(0,-1),h=parseInt(t.slice(-1))+this.octaveOffset,c=`${s}${h}`;if(!/^[A-G]#?\d$/.test(c)){console.error(`Invalid note format: ${c}`);return}console.log(`Playing note: ${c}`),this.synth.triggerAttackRelease(c,"8n"),this.noise.triggerAttackRelease("8n"),this.oscillationFrequency=o,n.material.color.set(this.colorPalette.paleSkyBlue),n.material.opacity=.9}releaseNote(){this.synth.triggerRelease(),this.noise.triggerRelease(),this.isHoldingRootRing&&(U.material.color.set(this.tunnelColor),U.material.opacity=.25,this.isHoldingRootRing=!1),this.isHoldingThirdRing&&(Q.material.color.set(this.tunnelColor),Q.material.opacity=.25,this.isHoldingThirdRing=!1),this.isHoldingFourth&&(J.material.color.set(this.tunnelColor),J.material.opacity=.25,this.isHoldingFourth=!1),this.isHoldingFifth&&(ee.material.color.set(this.tunnelColor),ee.material.opacity=.25,this.isHoldingFifth=!1),this.isHoldingSeventh&&(te.material.color.set(this.tunnelColor),te.material.opacity=.25,this.isHoldingSeventh=!1)}}r.add(l);r.add(Y);l.add(Y);const Co=Y.children,Go=R.paleSkyBlue,Fo=Z;new Lo(d,l,Co,p,x,Go,Fo);r.add(ho);r.add(H);r.add(Mt);r.add(Ue);r.add(z);r.add(Lt);r.add(Jt);r.add(I);r.add(Gt);r.add(Ft);r.add(S);r.add(Et);r.add(X);r.add(he);r.add(j);r.add(kt);r.add(Rt);r.add(W);r.add(C);r.add(G);r.add(F);r.add(E);r.fog=new jn(Zn,20,70);r.fog=new Nn(Un,.01);r.add(ge);const de=new f;de.add(ze);de.add(Ie);de.add(We);de.position.set(0,0,15);r.add(de);const Eo=16,ko=64,Ro=1,Oo=.866,To=.2,Ho=.05,zo=4,Io=tn(nn/3,xe/3,on/3,sn/3,Eo,ko),Le=new u(Io,gt);Le.position.set(0,xe/2+.65,15);r.add(Le);const Wo=Qe(Ro/3,Oo/3,To/3,Ho/3,zo),Ce=new u(Wo,gt),Ao=an(.8/3,.8/3,.8/3,.05/3,16),Ge=new u(Ao,gt);r.add(Ce,Ge);const Do=.7;Ce.position.set(-.7,xe/2+.5,15);Ge.position.set(Do,xe/2+.5,15);Le.visible=!0;Ce.visible=!0;Ge.visible=!0;const Fe=new f;Fe.add(Le);Fe.add(Ce);Fe.add(Ge);r.add(Fe);let Wt="sine";const At=[{mesh:Le,shape:"sine"},{mesh:Ce,shape:"pyramid"},{mesh:Ge,shape:"cube"}];window.addEventListener("click",e=>{var n;a.x=e.clientX/window.innerWidth*2-1,a.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(a,l);const t=d.intersectObjects([...At.map(o=>o.mesh),Ue]);if(t.length>0){const o=t[0].object,s=(n=At.find(i=>i.mesh===o))==null?void 0:n.shape;s&&Yo(s)}});function Yo(e){e!==Wt&&(ze.visible=e==="sine",We.visible=e==="pyramid",Ie.visible=e==="cube",e==="sine"?(ze.visible=!0,He.map=Bt,p.oscillator.type="sine"):e==="pyramid"?(We.visible=!0,He.map=Qn,p.oscillator.type="triangle"):e==="cube"&&(Ie.visible=!0,He.map=Jn,p.oscillator.type="square"),Wt=e)}const jo=.15;p.volume.value=me(jo);const Ee=new f;r.add(Ee);const Ae=7,dt=.2,No=.05,qo=new g({color:V,transparent:!0,opacity:.3,roughness:.5,metalness:.1});for(let e=0;e<Ae;e++){const t=new v(No,16,16),n=new u(t,qo.clone());n.position.set(1.5,e*dt,15),Ee.add(n)}let B=null;window.addEventListener("mousedown",e=>{a.x=e.clientX/window.innerWidth*2-1,a.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(a,l);const t=d.intersectObjects(Ee.children);t.length>0&&(B=t[0].object,B.scale.set(2,2,2))});H.intensity=1;window.addEventListener("mousemove",e=>{if(B){a.x=e.clientX/window.innerWidth*2-1,a.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(a,l);const t=new N(new y(0,0,1),-B.position.z),n=new y;d.ray.intersectPlane(t,n);const o=T.clamp(n.y,0,Ae*dt);B.position.y=o;const s=o/(Ae*dt);rn(s*100),p.volume.value=me(s/2);const i=s*5;H.intensity=i,B.visible=!0}});window.addEventListener("mouseup",()=>{B=null});function rn(e){const t=Math.round(e/100*Ae);Ee.children.forEach((n,o)=>{n.material.opacity=o<t?1:.3})}rn(15);const Je=new f;Je.add(de);Je.add(Fe);Je.add(Ee);r.add(Je);const Bo=0,Xo=0,_o=-5,we=new f;r.add(we);new qn({color:V,transparent:!0,opacity:.5});const $o=new Nt(.02,.02,.02);function Ko(e){const t=new u($o,ro),n=4,o=Math.random()*Math.PI*5,s=Math.acos(2*Math.random()-1);return t.position.set(n*Math.sin(s)*Math.cos(o),n*Math.sin(s)*Math.sin(o),n*Math.cos(s)),t.velocity=new y((Math.random()-.5)*.01,(Math.random()-.5)*.01,(Math.random()-.5)*.01),t}function cn(e,t){we.clear();for(let n=0;n<e;n++)we.add(Ko());console.log("Sending grain count to backend:",e)}we.position.set(Bo,Xo,_o);cn(500);const et=new f;r.add(et);const De=7,ut=.2,Vo=.05,Zo=new g({color:V,transparent:!0,opacity:.3,roughness:.5,metalness:.1});for(let e=0;e<De;e++){const t=new v(Vo,16,16),n=new u(t,Zo.clone());n.position.set(0+2.5,e*ut,-5),et.add(n)}let ne=null;window.addEventListener("mousedown",e=>{a.x=e.clientX/window.innerWidth*2-1,a.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(a,l);const t=d.intersectObjects(et.children);t.length>0&&(ne=t[0].object,ne.scale.set(2,2,2))});z.intensity=1;window.addEventListener("mousemove",e=>{if(ne){a.x=e.clientX/window.innerWidth*2-1,a.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(a,l);const t=new N(new y(0,0,1),-ne.position.z),n=new y;d.ray.intersectPlane(t,n);const o=T.clamp(n.y,0,De*ut);ne.position.y=o;const s=o/(De*ut);x.volume.value=me(s/2),cn(s*500),Uo(s*100);const i=s*5;z.intensity=i}});window.addEventListener("mouseup",()=>{ne=null});function Uo(e){const t=Math.round(e/100*De);et.children.forEach((n,o)=>{n.material.opacity=o<t?1:.3})}function Qo(e,t,n,o,s){const i=new f,h=new $e;h.moveTo(-2.5/2,0),h.lineTo(e/2,0);const c=T.degToRad(s),w=Math.cos(c)*t,b=-Math.sin(c)*t;h.lineTo(e/2+w,b),h.quadraticCurveTo(e/2,0,-2.5/2,.2);const A={steps:10,depth:n,bevelEnabled:!0,bevelThickness:o*3,bevelSize:o,bevelSegments:32},m=new Ke(h,A);m.center();const D=new u(m,L);return i.add(D),i}const Jo=2.5,es=2,ts=.1,ns=.2,os=30,ln=Qo(Jo,es,ts,ns,os);ln.position.set(0,0,-26);r.add(ln);const tt=new f;r.add(tt);const Ye=7,ht=.2,ss=.05,dn=new g({color:V,transparent:!0,opacity:.3,roughness:.5,metalness:.1});for(let e=0;e<Ye;e++){const t=new v(ss,16,16),n=new u(t,dn.clone());t.center(),n.position.set(2.5,e*ht,-25),tt.add(n)}let oe=null;window.addEventListener("mousedown",e=>{a.x=e.clientX/window.innerWidth*2-1,a.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(a,l);const t=d.intersectObjects(tt.children);t.length>0&&(oe=t[0].object,oe.scale.set(2,2,2))});I.intensity=1;window.addEventListener("mousemove",e=>{if(oe){a.x=e.clientX/window.innerWidth*2-1,a.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(a,l);const t=new N(new y(0,0,1),-oe.position.z),n=new y;d.ray.intersectPlane(t,n);const o=T.clamp(n.y,0,Ye*ht);oe.position.y=o;const s=o/(Ye*ht),i=20,c=i*Math.pow(2e4/i,s);q.frequency.value=c,console.log("Logarithmic Filter Cutoff Frequency:",c),console.log(s*2e4),is(s*100);const w=s*5;I.intensity=w}});window.addEventListener("mouseup",()=>{oe=null});function is(e){const t=Math.round(e/100*Ye);tt.children.forEach((n,o)=>{n.material.opacity=o<t?1:.3})}const nt=new f;r.add(nt);const je=7,wt=.2,as=.05;for(let e=0;e<je;e++){const t=new v(as,16,16),n=new u(t,dn.clone());t.center(),n.position.set(-2.5,e*wt,-25),nt.add(n)}let se=null;window.addEventListener("mousedown",e=>{a.x=e.clientX/window.innerWidth*2-1,a.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(a,l);const t=d.intersectObjects(nt.children);t.length>0&&(se=t[0].object,se.scale.set(2,2,2))});window.addEventListener("mousemove",e=>{if(se){a.x=e.clientX/window.innerWidth*2-1,a.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(a,l);const t=new N(new y(0,0,1),-se.position.z),n=new y;d.ray.intersectPlane(t,n);const o=T.clamp(n.y,0,je*wt);se.position.y=o;const s=o/(je*wt),i=20,c=i*Math.pow(100/i,s);q.Q.value=c/10,console.log("Logarithmic Q",c),console.log(s),rs(s*100)}});window.addEventListener("mouseup",()=>{se=null});function rs(e){const t=Math.round(e/100*je);nt.children.forEach((n,o)=>{n.material.opacity=o<t?1:.3})}const ot=new f,cs=25,ls=1.5;for(let e=0;e<cs;e++){const t=ls+(Math.random()-.5)*.1,n=Math.random()*Math.PI*2;let o;const s=Math.random();s<.33?o=new v(.05*Math.random()+.03,8,8):s<.66?o=new Nt(.05*Math.random()+.03,.05*Math.random()+.03,.05*Math.random()+.03):o=new Bn(.05*Math.random()+.03,0);const i=new u(o,L);i.position.set(t*Math.cos(n),t*Math.sin(n),0),i.rotation.set(Math.random()*Math.PI,Math.random()*Math.PI,Math.random()*Math.PI),i.userData={initialPosition:i.position.clone(),scale:1},ot.add(i)}ot.position.set(0,0,-45);r.add(ot);const ds=new Yt(2,2,.1,32),us=new g({opacity:0,transparent:!0}),un=new u(ds,us);un.rotation.x=Math.PI/2;un.position.z=-45;function hs(){const e=Date.now()*.001;ot.children.forEach(t=>{const{initialPosition:n,scale:o}=t.userData;t.position.x=n.x+Math.sin(e+t.id)*.1,t.position.y=n.y+Math.cos(e+t.id)*.1,t.scale.set(o,o,o)})}const ws=new Xn;ws.load("fonts/P22 FLLW Exhibition_Regular.json",function(e){function t(Ln,Cn){return new Kn(Ln,{font:Cn,size:11,height:2,curveSegments:12,bevelEnabled:!0,bevelThickness:.1,bevelSize:.5,bevelOffset:0,bevelSegments:5})}const n=t("A",e);t("D",e),t("S",e),t("R",e),new _n,new u(n,Ve);const o=.08,s=t("OSC",e),i=new u(s,ue);i.position.set(-2.7,8,18.4),i.scale.set(o,o,o),i.rotation.x=Math.PI/2,i.castShadow=!0,i.receiveShadow=!0,i.transparent=!0,r.add(i),W.target=Ue;const h=t("Noise",e),c=new u(h,ue);c.position.set(-3.2,8,-1.6),c.scale.set(o,o,o),c.rotation.x=Math.PI/2,c.castShadow=!0,c.transparent=!0,r.add(c),C.target=c;const w=t("Filter",e),b=new u(w,ue);b.position.set(-2.9,8,-21.6),b.scale.set(o,o,o),b.rotation.x=Math.PI/2,b.castShadow=!0,b.transparent=!0,r.add(b),G.target=Ft;const A=t("LFO",e),m=new u(A,ue);m.position.set(-2.8,7.5,-44.3),m.scale.set(o,o,o),m.rotation.x=Math.PI/2,m.castShadow=!0,m.transparent=!0,r.add(m),F.target=X;const D=t("adsr",e),P=new u(D,ue);P.position.set(-3.5,7.7,-63.7),P.scale.set(o,o,o),P.rotation.x=Math.PI/2,P.castShadow=!0,P.transparent=!0,r.add(P),E.target=Rt});const st=new f;r.add(st);const Ne=10,pt=.2,ps=.05,ms=new g({color:L,transparent:!0,opacity:.3,roughness:.5,metalness:.1});for(let e=0;e<Ne;e++){const t=new v(ps,16,16),n=new u(t,ms.clone());n.position.set(-3,e*pt,-65),st.add(n)}let ie=null;window.addEventListener("mousedown",e=>{a.x=e.clientX/window.innerWidth*2-1,a.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(a,l);const t=d.intersectObjects(st.children);t.length>0&&(ie=t[0].object,ie.scale.set(2,2,2))});window.addEventListener("mousemove",e=>{if(ie){a.x=e.clientX/window.innerWidth*2-1,a.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(a,l);const t=new N(new y(0,0,1),-ie.position.z),n=new y;d.ray.intersectPlane(t,n);const o=T.clamp(n.y,0,Ne*pt);ie.position.y=o;const s=o/(Ne*pt);console.log(`Volume Level: ${s.toFixed(2)}`),p.envelope.attack=s,x.envelope.attack=s,hn(s*100)}});window.addEventListener("mouseup",()=>{ie=null});function hn(e){const t=Math.round(e/100*Ne);st.children.forEach((n,o)=>{o<t?n.material.opacity=1:n.material.opacity=.3})}hn(10);const it=new f;r.add(it);const qe=10,mt=.2,ys=.05,fs=new g({color:L,transparent:!0,opacity:.3,roughness:.5,metalness:.1});for(let e=0;e<qe;e++){const t=new v(ys,16,16),n=new u(t,fs.clone());n.position.set(-1,e*mt,-65),it.add(n)}let ae=null;window.addEventListener("mousedown",e=>{a.x=e.clientX/window.innerWidth*2-1,a.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(a,l);const t=d.intersectObjects(it.children);t.length>0&&(ae=t[0].object,ae.scale.set(2,2,2))});window.addEventListener("mousemove",e=>{if(ae){a.x=e.clientX/window.innerWidth*2-1,a.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(a,l);const t=new N(new y(0,0,1),-ae.position.z),n=new y;d.ray.intersectPlane(t,n);const o=T.clamp(n.y,0,qe*mt);ae.position.y=o;const s=o/(qe*mt);p.envelope.decay=s,x.envelope.decay=s,console.log(`Decay Level: ${s.toFixed(2)}`),wn(s*100)}});window.addEventListener("mouseup",()=>{ae=null});function wn(e){const t=Math.round(e/100*qe);it.children.forEach((n,o)=>{o<t?n.material.opacity=1:n.material.opacity=.3})}wn(10);const at=new f;r.add(at);const Be=10,yt=.2,gs=.05,vs=new g({color:L,transparent:!0,opacity:.3,roughness:.5,metalness:.1});for(let e=0;e<Be;e++){const t=new v(gs,16,16),n=new u(t,vs.clone());n.position.set(1,e*yt,-65),at.add(n)}let re=null;window.addEventListener("mousedown",e=>{a.x=e.clientX/window.innerWidth*2-1,a.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(a,l);const t=d.intersectObjects(at.children);t.length>0&&(re=t[0].object,re.scale.set(2,2,2))});window.addEventListener("mousemove",e=>{if(re){a.x=e.clientX/window.innerWidth*2-1,a.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(a,l);const t=new N(new y(0,0,1),-re.position.z),n=new y;d.ray.intersectPlane(t,n);const o=T.clamp(n.y,0,Be*yt);re.position.y=o;const s=o/(Be*yt);p.envelope.sustain=s,x.envelope.sustain=s,pn(s*100)}});window.addEventListener("mouseup",()=>{re=null});function pn(e){const t=Math.round(e/100*Be);at.children.forEach((n,o)=>{o<t?n.material.opacity=1:n.material.opacity=.3})}pn(10);const rt=new f;r.add(rt);const Xe=10,ft=.2,bs=.05,Ps=new g({color:L,transparent:!0,opacity:.3,roughness:.5,metalness:.1});for(let e=0;e<Xe;e++){const t=new v(bs,16,16),n=new u(t,Ps.clone());n.position.set(3,e*ft,-65),rt.add(n)}let ce=null;window.addEventListener("mousedown",e=>{a.x=e.clientX/window.innerWidth*2-1,a.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(a,l);const t=d.intersectObjects(rt.children);t.length>0&&(ce=t[0].object,ce.scale.set(2,2,2))});window.addEventListener("mousemove",e=>{if(ce){a.x=e.clientX/window.innerWidth*2-1,a.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(a,l);const t=new N(new y(0,0,1),-ce.position.z),n=new y;d.ray.intersectPlane(t,n);const o=T.clamp(n.y,0,Xe*ft);ce.position.y=o;const s=o/(Xe*ft);p.envelope.release=s,x.envelope.release=s,mn(s*100)}});window.addEventListener("mouseup",()=>{ce=null});function mn(e){const t=Math.round(e/100*Xe);rt.children.forEach((n,o)=>{o<t?n.material.opacity=1:n.material.opacity=.3})}mn(10);let Ot=!1,Tt=!1,Ht=!1,zt=!1;const Ms=.2,Dt=.02;window.addEventListener("keydown",e=>{switch(e.preventDefault(),e.key.toLowerCase()){case"w":Ot=!0,Oe=0;break;case"s":Tt=!0,Oe=0;break;case"a":Ht=!0,Oe=0;break;case"d":zt=!0,Oe=0;break}});window.addEventListener("keyup",e=>{switch(e.key.toLowerCase()){case"w":Ot=!1;break;case"s":Tt=!1;break;case"a":Ht=!1;break;case"d":zt=!1;break}});const yn=.05,fn=.0466,gn=.001,vn=.0025,bn=4,pe=new $n({color:R.sageGreen}),Ss=Qe(yn,fn,gn,vn,bn),xs=new u(Ss,pe);xs.visible=!0;const ke=new f;function Pn(e){const t=new f,n=Qe(yn,fn,gn,vn,bn),o=new u(n,pe);return o.position.y=0,t.add(o),t}const ct=Pn();ct.scale.set(.1,.1,.1);const Re=Pn();Re.scale.set(.1,.1,.1);Re.rotation.z=Math.PI;const Mn=.15,Sn=-.035;ct.position.set(Mn-.108,Sn,-.2);Re.position.set(Mn-.1,Sn,-.2);ct.rotation.z=Math.PI*.5;Re.rotation.z=Math.PI*1.5;ke.add(ct);ke.add(Re);r.add(ke);window.addEventListener("keydown",e=>{switch(e.preventDefault(),e.key){case"ArrowRight":pe.color.set(R.sunlitSand),updateBackground();break;case"ArrowLeft":pe.color.set(R.oliveBrown),updateBackground();break}});window.addEventListener("keyup",e=>{switch(e.preventDefault(),e.key){case"ArrowRight":case"ArrowLeft":pe.color.set(R.sageGreen),updateBackground();break}});ke.position.set(-.048,-.11,0);l.add(ke);let lt=!1;window.addEventListener("click",e=>{a.x=e.clientX/window.innerWidth*2-1,a.y=-(e.clientY/window.innerHeight)*2+1,d.setFromCamera(a,l),d.intersectObject(X).length>0&&(X.visible=!X.visible,he.visible=!he.visible,lt?(S.intensity=0,lt=!1):(S.intensity=lightIntensity,lt=!0))});let Oe=.5;const Te={minZ:-85,maxZ:45,radius:9.5};function xn(){requestAnimationFrame(xn),hs(),Ht&&(l.rotation.y+=Dt),zt&&(l.rotation.y-=Dt);const e=new y;l.getWorldDirection(e),Ot&&l.position.add(e.multiplyScalar(Ms)),Tt&&l.position.add(e.multiplyScalar(-.2)),l.position.z=T.clamp(l.position.z,Te.minZ,Te.maxZ);const t=Math.sqrt(l.position.x**2+l.position.y**2);if(t>Te.radius){const n=Te.radius/t;l.position.x*=n,l.position.y*=n}we.children.forEach(n=>{n.position.add(n.velocity);const o=1.25;n.position.length()>o&&(n.position.normalize().multiplyScalar(o),n.velocity.negate()),n.material.opacity=3}),$.render(r,l)}xn();
